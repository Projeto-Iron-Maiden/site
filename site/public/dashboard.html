<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DASHBOARD</title>
    <link rel="stylesheet" href="styles/dashboard.css">
    <link href='https://fonts.googleapis.com/css?family=times new roman' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>IRON MAIDEN</title>

    <header class="header">
        <div class="logo">
            <span>IRON MAIDEN</span>
        </div>
        <div class="buttons">
            <a href="playlist.html" style="--anima:#00F519"><span>Playlist</span></a>
            <a href="albuns.html" style="--anima:#8a2be2"><span>álbuns</span></a>
            <a href="index.html" style="--anima:#ff0000"><span>home</span></a>
        </div>
    </header>

</head>

<body>
    <div class="container">
        <div class="chart-container">
            <div id="chart1" class="chart"><canvas id="Vendas_Chart"></canvas></div>
        </div>
        <div class="chart-container">
            <div id="chart2" class="chart"><canvas id="Vezes_Chart"></canvas></div>
        </div>
        <div class="chart-container">
            <div id="chart3" class="chart"><canvas id="Favoritos_Chart"></canvas></div>
        </div>
        <div class="chart-containerBola">
            <div id="chart4" class="chartBola"><canvas id="Pais_Chart"></canvas></div>
        </div>
    </div>

</body>

</html>
<script>
    window.onload = calcularVezes()
    window.onload = calcularFavoritos()

    var VironMaiden = 4175000
    var Vkillers = 4855000
    var Vnumberofbeast = 8330000
    var Vpieceofmind = 6615000
    var Vpowerslave = 5610000
    var Vsomewhere = 5290000
    var Vseventh = 4815000
    var Vnoprayer = 3010000
    var Vfearofthedark = 3615000
    var Vxfactor = 1410000
    var Vvirtualxi = 1185000
    var Vbravenew = 2290000
    var Vdanceofdeath = 1490000
    var Vmatteroflife = 1440000
    var Vfinalfrontier = 1120000
    var Vbookofsouls = 1090000
    var Vsenjutsu = 480000

    const ctx = document.getElementById('Vendas_Chart');
    const ctx2 = document.getElementById('Vezes_Chart');
    const ctx3 = document.getElementById('Favoritos_Chart');
    const ctx4 = document.getElementById('Pais_Chart');
    var vetorAlbuns = []
    var vetorFavoritos = []

    function calcularVezes() {

        fetch(`/album/calcularVezes/`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    console.log(resposta)
                    for (var c = 0; c < resposta.length; c++) {
                        var registro = resposta[c];
                        vetorAlbuns.push(registro.vezes);

                    }
                    console.log(vetorAlbuns);
                    new Chart(ctx2, {
                        type: 'bar',
                        data: {
                            labels: ['Iron Maiden 1980', 'Killers 1981', 'The Number of the Beast 1982', 'Piece of Mind 1983', 'Powerslave 1984', 'Somewhere in Time 1986', 'Seventh Son of a Seventh Son 1988', 'No Prayer for the Dying 1990', 'Fear of the Dark 1992', 'The X Factor 1995', 'Virtual XI 1998', 'Brave New World 2000', 'Dance of Death 2003', 'A Matter of Life and Death 2006', 'The Final Frontier 2010', 'The Book of Souls 2015', 'Senjutsu 2021'],
                            datasets: [{
                                label: 'Álbuns mais clicados no site',
                                data: vetorAlbuns,
                                backgroundColor: [
                                    'rgba(181,163,59,0.8)',
                                    'rgba(218,207,203,0.8)',
                                    'rgba(255, 0, 0, 0.8)',
                                    'rgba(226,218,105,0.8)',
                                    'rgba(222,177,117,0.8)',
                                    'rgba(143,173,207,0.8)',
                                    'rgba(159,201,216,0.8)',
                                    'rgba(72,60,132,0.8)',
                                    'rgba(0,0,0,0.5)',
                                    'rgba(144,103,132,0.8)',
                                    'rgba(234,119,46,0.8)',
                                    'rgba(76,66,133,0.8)',
                                    'rgba(202,184,132,0.8)',
                                    'rgba(79,87,74,0.8)',
                                    'rgba(71,117,45,0.8)',
                                    'rgba(235,235,235,0.8)',
                                    'rgba(160,61,59,0.8)'

                                ],
                                borderWidth: 4,
                                borderColor: [
                                    'rgba(181,163,59,255)',
                                    'rgba(218,207,203,255)',
                                    'rgba(255, 0, 0, 1)',
                                    'rgba(226,218,105,255)',
                                    'rgba(222,177,117,255)',
                                    'rgba(143,173,207,255)',
                                    'rgba(159,201,216,255)',
                                    'rgba(72,60,132,255)',
                                    'rgba(0,0,0,255)',
                                    'rgba(144,103,132,255)',
                                    'rgba(234,119,46,255)',
                                    'rgba(76,66,133,255)',
                                    'rgba(202,184,132,255)',
                                    'rgba(79,87,74,255)',
                                    'rgba(71,117,45,255)',
                                    'rgba(235,235,235,255)',
                                    'rgba(160,61,59,255)',

                                ]
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: 'white'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'white'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Álbuns mais clicados nas músicas aleatórias',
                                    color: 'white',
                                    font: {
                                        size: 13
                                    }
                                },

                                legend: {
                                    display: false,
                                    labels: {
                                        text: 'Álbuns mais clicados nas músicas aleatórias',
                                        color: 'white'  // Define a cor da fonte da legenda como branco
                                    }
                                }
                            }
                        }
                    });

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }


    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Iron Maiden 1980', 'Killers 1981', 'The Number of the Beast 1982', 'Piece of Mind 1983', 'Powerslave 1984', 'Somewhere in Time 1986', 'Seventh Son of a Seventh Son 1988', 'No Prayer for the Dying 1990', 'Fear of the Dark 1992', 'The X Factor 1995', 'Virtual XI 1998', 'Brave New World 2000', 'Dance of Death 2003', 'A Matter of Life and Death 2006', 'The Final Frontier 2010', 'The Book of Souls 2015', 'Senjutsu 2021'],
            datasets: [{
                label: 'Vendas de discos em milhões de unidades',
                data: [VironMaiden, Vkillers, Vnumberofbeast, Vpieceofmind, Vpowerslave, Vsomewhere, Vsomewhere, Vnoprayer, Vfearofthedark, Vxfactor, Vvirtualxi, Vbravenew, Vdanceofdeath, Vmatteroflife, Vfinalfrontier, Vbookofsouls, Vsenjutsu],
                backgroundColor: [
                    'rgba(181,163,59,0.8)',
                    'rgba(218,207,203,0.8)',
                    'rgba(255, 0, 0, 0.8)',
                    'rgba(226,218,105,0.8)',
                    'rgba(222,177,117,0.8)',
                    'rgba(143,173,207,0.8)',
                    'rgba(159,201,216,0.8)',
                    'rgba(72,60,132,0.8)',
                    'rgba(0,0,0,0.5)',
                    'rgba(144,103,132,0.8)',
                    'rgba(234,119,46,0.8)',
                    'rgba(76,66,133,0.8)',
                    'rgba(202,184,132,0.8)',
                    'rgba(79,87,74,0.8)',
                    'rgba(71,117,45,0.8)',
                    'rgba(235,235,235,0.8)',
                    'rgba(160,61,59,0.8)'

                ],
                borderWidth: 4,
                borderColor: [
                    'rgba(181,163,59,255)',
                    'rgba(218,207,203,255)',
                    'rgba(255, 0, 0, 1)',
                    'rgba(226,218,105,255)',
                    'rgba(222,177,117,255)',
                    'rgba(143,173,207,255)',
                    'rgba(159,201,216,255)',
                    'rgba(72,60,132,255)',
                    'rgba(0,0,0,255)',
                    'rgba(144,103,132,255)',
                    'rgba(234,119,46,255)',
                    'rgba(76,66,133,255)',
                    'rgba(202,184,132,255)',
                    'rgba(79,87,74,255)',
                    'rgba(71,117,45,255)',
                    'rgba(235,235,235,255)',
                    'rgba(160,61,59,255)',

                ]
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        color: 'white'
                    }
                },
                x: {
                    ticks: {
                        color: 'white'
                    }
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: 'Vendas de discos do Iron Maiden por álbum',
                    color: 'white',
                    font: {
                        size: 13
                    }
                },
                legend: {
                    display: false,
                    labels: {
                        text: 'Vendas de discos do Iron Maiden por álbum',
                        color: 'white'
                    }
                }
            }
        }
    });
    function calcularFavoritos() {

        fetch(`/album/calcularFavoritos/`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    console.log(resposta)
                    for (var c2 = 0; c2 < resposta.length; c2++) {
                        var registro2 = resposta[c2];
                        vetorFavoritos.push(registro2.quantidade);
                    }
                    console.log(vetorFavoritos);
                    new Chart(ctx3, {
                        type: 'bar',
                        data: {
                            labels: ['Iron Maiden 1980', 'Killers 1981', 'The Number of the Beast 1982', 'Piece of Mind 1983', 'Powerslave 1984', 'Somewhere in Time 1986', 'Seventh Son of a Seventh Son 1988', 'No Prayer for the Dying 1990', 'Fear of the Dark 1992', 'The X Factor 1995', 'Virtual XI 1998', 'Brave New World 2000', 'Dance of Death 2003', 'A Matter of Life and Death 2006', 'The Final Frontier 2010', 'The Book of Souls 2015', 'Senjutsu 2021'],
                            datasets: [{
                                label: 'Álbuns favoritos',
                                data: vetorFavoritos,
                                backgroundColor: [
                                    'rgba(181,163,59,0.8)',
                                    'rgba(218,207,203,0.8)',
                                    'rgba(255, 0, 0, 0.8)',
                                    'rgba(226,218,105,0.8)',
                                    'rgba(222,177,117,0.8)',
                                    'rgba(143,173,207,0.8)',
                                    'rgba(159,201,216,0.8)',
                                    'rgba(72,60,132,0.8)',
                                    'rgba(0,0,0,0.5)',
                                    'rgba(144,103,132,0.8)',
                                    'rgba(234,119,46,0.8)',
                                    'rgba(76,66,133,0.8)',
                                    'rgba(202,184,132,0.8)',
                                    'rgba(79,87,74,0.8)',
                                    'rgba(71,117,45,0.8)',
                                    'rgba(235,235,235,0.8)',
                                    'rgba(160,61,59,0.8)'

                                ],
                                borderWidth: 4,
                                borderColor: [
                                    'rgba(181,163,59,255)',
                                    'rgba(218,207,203,255)',
                                    'rgba(255, 0, 0, 1)',
                                    'rgba(226,218,105,255)',
                                    'rgba(222,177,117,255)',
                                    'rgba(143,173,207,255)',
                                    'rgba(159,201,216,255)',
                                    'rgba(72,60,132,255)',
                                    'rgba(0,0,0,255)',
                                    'rgba(144,103,132,255)',
                                    'rgba(234,119,46,255)',
                                    'rgba(76,66,133,255)',
                                    'rgba(202,184,132,255)',
                                    'rgba(79,87,74,255)',
                                    'rgba(71,117,45,255)',
                                    'rgba(235,235,235,255)',
                                    'rgba(160,61,59,255)',

                                ]
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: 'white'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'white'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Álbuns mais clicados nas músicas aleatórias',
                                    color: 'white',
                                    font: {
                                        size: 13
                                    }
                                },

                                legend: {
                                    display: false,
                                    labels: {
                                        text: 'Álbuns favoritos dos usuarios',
                                        color: 'white'
                                    }
                                }
                            }
                        }
                    });

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    new Chart(ctx4, {
        type: 'pie',
        data: {
            labels: ['São Paulo', 'Santiago', 'Mexico City', 'Helsinki', 'London'],
            datasets: [{
                label: 'Ouvintes mensais',
                data: [236375, 221979, 214808, 113615, 111666],
                backgroundColor: ['rgba(165, 205, 233, 0.8)', 'rgba(246, 191, 38, 0.8)', 'rgba(255, 123, 123, 0.8)', 'rgba(153, 230, 179, 0.8)', 'rgba(204, 204, 204, 0.8)'],
                borderColor: ['rgba(165, 205, 233, 1)', 'rgba(246, 191, 38, 1)', 'rgba(255, 123, 123, 1)', 'rgba(153, 230, 179, 1)', 'rgba(204, 204, 204, 1)'],
                borderWidth: 4
            }]
        },
        options: {

            plugins: {
                title: {
                    display: true,
                    text: 'Cidades que mais ouvem Iron Maiden',
                    color: 'white',
                    font: {
                        size: 20,
                        weight: 'bold',
                        color: 'white'
                    },
                    padding: {
                        top: 0,
                        bottom: 0,

                    }
                },
                legend: {
                    display: true,
                    position: 'right',
                    labels: {
                        color: 'white',
                        font: {
                            size: 14,
                            color: 'white'
                        }

                    }
                }
            },
            layout: {
                padding: {
                    top: 20

                }
            }
        }
    });


</script>